# 標準入力関係

C言語の標準入力関係について述べていく

以下に標準入力に使える関数を記述する。

- strtok
- puts
- fgets
- sscanf
- atoi
- scanf

# 入力数の分からない不定形のstrの入力の変換

paizaで使いたい奴のサンプルコード

ex)sample.c

# strtok

文字列をトークン(単位)に分ける事ができる。

```
//1回目呼び出し
strtok(s1,s2);
//2回目以降呼び出し
strtok(NULL,s2);
```
- s1 : 処理をしたい文字列 
- s2 : 単位に分ける基準点
- NULL : ただのNULL,これが2回目以降の単位分けに使用される。これは決まり

- 分解できるトークンがなくなった場合にはNULLを返す。
## 挙動について

1回目の呼び出しで渡された文字列をポインタをstrtok関数の内部に保持をしている。２回目以降はそれを使用している。

strtokは元々あった文字列を書き換えている。

strokeは、s2で渡された文字をs1内で探す。s1で該当場所があった場合にそこをNULL(\0)に書き換える。`C言語ではNULLが現れるとそこまでが文字列と認識される。`つまり先頭からNULLまでの最初の文字列を返り値として出力している。

なので、1回目の処理以降に出力したくてもNULLによってそれ以降の文字列は出力できない。

例えば,31.23.34.3を.で区切る場合。まず1回目で31を抜き出す。

そしてループ内では23,34,3とNULLを為にstrtokが4回分が呼ばれる。

しかし、この挙動によってstrtok途中では別の文字列に対するstrtokを使う事ができなくなる。

## 挙動について

まず各種変数について

```
char str[100];
char delim[] =" \n";
char *token;
int num;
```

- str : 標準入力を受け取る文字列
- delim : 区切り文字を持つ文字列
- *token : 最終的に区切りたい文字列のアドレス
- num : int型へキャストされた文字列を受け取る変数

次にwhileに入るまでの処理について説明する。

```
fgets(str,sizeof(str),stdin);

token = strtok(str,delim);
```

fgetsでキーボード入力からの文字列をstrへ渡す。そしてstrtokを使う事で区切り文字に決めた空白までにある文字列(配列)をポインタ型変数のtokenに渡す。

最後に繰り返しの処理

```
while (token != NULL) {

    num = atoi(token);

    //printfは省略

    token = strtok(NULL, delim);
}
```

tokenには基本区切り文字が入る。しかし最後まで行くとNULLが代入される。

atoiでstrからintへのキャストをしている。

strtokでは第1引数にNULLを指定すると、その前のstrtokでNULLに置き換えた位置の次のアドレス(つまり次に切り取りたい文字列の先頭部分)を自動的に指定してくれる。これをループすることで空白で文字列を切り取り続ける。

strtokの使用は細かいので次の説明に回す。


# puts

文字列を出力するのに特化している関数。変数は無理

正常に処理が成功した場合、おそらく文字列の値が返される。失敗した場合にはEOFが返ってくるらしい。

```
int n;

n = puts("test");

printf("%d\n",n);

--ターミナル出力---------------------
test
5
```

# fgets

入力ストリーム(データの流れ)から文字列を取得することができる。

```
fgets(str,numchars,stream)
```
- str : 受け取る文字列変数
- numchars : 受け取る最大の文字数
- stream : 構造体へのポインタ

streamでストリームを決めたら流れてきたデータをstrへ渡す。なお受け取る数はnumcharsで制限する。

以下のようにすることで、標準入力の受け取りに使える

```
fgets(str,sizeof(str),stdin);
```

- str : 受け取る文字列を代入するchar型の配列
- sizeof(str) : sizeofでstrに合わせた最大文字数を決める事ができる。
- stdin : キーボードからの標準入力を受け取る標準ストリーム

# sscanf

文字列から書式付きデータを読みだす事ができる。書式を指定できるので同時にキャストも行える。

```
sscanf(str,format,locale);
```

- str : 使用するデータ
- formata : 書式指定
- locale : データの格納場所

strから渡されたデータがformatに従って型変換されて、localeで指定した変数やアドレスに渡される。

戻り値としては、localeに渡す事が出来た変数の数を返してくれる。処理が一切されない時にはEOFを返す。

```
int n;
n = sscanf(~~);
```
ex)fgets_sscanf_input.c

第2引数ではint型とdouble型をそれぞれ指定している。するとchar型の配列を指定した型に変換して第3引数で指定した変数などに渡す。

# atoi

文字列を整数に変換する。`atof`など使うとdoubleにもできる。

ex) fgets_atoi.c


# scanf

いつもの入力。だけどこれは通常使われないらしい。使われたらネットで絡まれるから注意。